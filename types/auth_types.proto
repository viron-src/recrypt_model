// Copyright © Viron Software ⨈
syntax = "proto3";
package recrypt.types;

message SessionStateRequest {
  // Blank request, cookie data will be included by default for browser web requests at metadata.
  // Cookie name: session_key
}

message SessionStateResponse {
  string email = 1; // Empty email means we're not logged in. In which case the other fields are ignored.
  string first_name = 2;
  string last_name = 3;
}

message LoginRequest {
  string email = 1; // Must be valid email. Min 3 characters. Max 254 characters.
  string password = 2; // Min 8 characters. Max 64 characters.
  string totp = 3; // 6 characters only (numbers)
}

message LoginResponse {
  // If 1 then there will be Set-Cookie in the header/metadata with the sessionkey.
  // If 2 then totp is required.
  // If 0 then failure.
  int32 result = 1;
}

message LogoutRequest {
  // If the "session_key" cookie is provided with this request, it will be cleared from the listed of sessions for this user.
}

message LogoutResponse {
  // Specifically the cookie session_key will be told to expire on the response.
  // This response will always clear session_key cookies from the browser.
}

message ConsumeTokenRequest {
  int64 seq = 1; // Must be zero or higher.
  string token = 2; // Must be a 64-character hexadecimal string.
  oneof op {
    string password = 3; // Min 8 characters. Max 64 characters. Requires zxcvbn score of atleast 3.
  }
}

message ConsumeTokenResponse {
  int32 state = 1; // 0 = invalid token, 1 = success, 2 = try again with password (verify email).
}