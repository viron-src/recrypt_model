// Copyright © Viron Software ⨈
syntax = "proto3";
package recrypt.types;

message SessionStateRequest {
  // Blank request, cookie data will be included by default for browser web requests at metadata.
  // Cookie name: session_key
}

message SessionStateResponse {
  string email = 1; // Empty email means we're not logged in. In which case the other fields are ignored.
  string first_name = 2;
  string last_name = 3;
}

message LoginRequest {
  string email = 1; // Must be valid email. Min 3 characters. Max 254 characters.
  string password = 2; // Min 8 characters. Max 64 characters.
  bool stay_signed_in = 3; // Adjusts the Set-Cookie session_key response to be more persistent.
}

message LoginResponse {
  bool success = 1; // If true there will be Set-Cookie in the header/metadata with the session_key.
}

message LogoutRequest {
  // If the "session_key" cookie is provided with this request, it will be cleared from the listed of sessions for this user.
}

message LogoutResponse {
  // Specifically the cookie session_key will be told to expire on the response.
  // This response will always clear session_key cookies from the browser.
}